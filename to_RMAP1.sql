SELECT * FROM ROADMAP.STUDY_METRIC_HEARTRATE where PRTCPT_DVC_ID = 1563

begin
   dbms_stats.gather_table_stats('ROADMAP','STUDY_METRIC_HEARTRATE');
end;

select * from roadmap.study_metric_aggregates

SELECT * FROM roadmap.SLEEP_SUMMARY where STUDY_PRTCPT_ID = 'XGJ8AFS8'

select PRTCPT_DVC_ID, STUDY_PRTCPT_ID from roadmap.prtcpt_dvc
SELECT *FROM ROADMAP.PRTCPT_DVC WHERE STUDY_PRTCPT_ID = '5NQHT686'

select * from roadmap.prtcpt_dvc where PRTCPT_DVC_ID = 26693


select count( distinct(study_prtcpt_id)) from roadmap.study_metric_aggregates

SELECT * FROM roadmap.STUDY_METRIC_STEPS where PRTCPT_DVC_ID = 27414 AND STUDY_METRIC_MSR_START_DT = '2023-04-29 00:09:00' 

SELECT COUNT (DISTINCT(STUDY_METRIC_TYP_ID)) FROM ROADMAP.STUDY_METRIC_STEPS

SELECT DISTINCT(STUDY_METRIC_TYP_ID) FROM ROADMAP.STUDY_METRIC_STEPS


select PRTCPT_DVC_ID, STUDY_METRIC_MSR_VAL, STUDY_METRIC_MSR_START_DT,STUDY_METRIC_MSR_END_DT from roadmap.STUDY_METRIC_STEPS where STUDY_METRIC_TYP_ID = 20 and PRTCPT_DVC_ID = '" + str(i) 

select PRTCPT_DVC_ID, STUDY_METRIC_MSR_VAL, STUDY_METRIC_MSR_START_DT,STUDY_METRIC_MSR_END_DT from roadmap.STUDY_METRIC_STEPS

SELECT * FROM ROADMAP.STUDY_METRIC_STEPS WHERE PRTCPT_DVC_ID = 26154

SELECT *FROM ROADMAP.STUDY_METRIC_HEARTRATE WHERE PRTCPT_DVC_ID = 26154
select PRTCPT_DVC_ID, STUDY_METRIC_MSR_VAL, STUDY_METRIC_MSR_START_DT,STUDY_METRIC_MSR_END_DT from roadmap.STUDY_METRIC_STEPS where STUDY_METRIC_TYP_ID = 20 

select STUDY_METRIC_MSR_VAL, STUDY_METRIC_MSR_START_DT from ROADMAP.STUDY_METRIC_HEARTRATE where PRTCPT_DVC_ID = 1561

select *from ROADMAP.STUDY_METRIC_HEARTRATE where PRTCPT_DVC_ID = 26774 and STUDY_METRIC_TYP_ID = 3

SELECT * FROM ROADMAP.PRTCPT_DVC WHERE STUDY_PRTCPT_ID = 'CFI9I6K2'    

select count(distinct(PRTCPT_DVC_ID)) from ROADMAP.PRTCPT_DVC WHERE STUDY_ID = 323

SELECT * FROM roadmap.STUDY_METRIC_STEPS where PRTCPT_DVC_ID = 24916

SELECT *FROM ROADMAP.PRTCPT_DVC WHERE STUDY_PRTCPT_ID = 'CTCF3BLF'

SELECT * FROM ROADMAP.PRTCPT_DVC WHERE STUDY_PRTCPT_ID IN ('9R635ZTE','B2XG1A56','846FA27M','NWYLNHF7','TUGRXQDH','HISGXBPE','VRM4NEGK','6UH2QBTR','GDEF52J4','NW5ZIG6X')
SELECT * FROM ROADMAP.SLEEP_SUMMARY WHERE STUDY_PRTCPT_ID IN ('CTCF3BLF', 'HP5X93MQ','D2M2ZZYX','3S7LUJ1V','WTI3RXPU','81AAL6VD','RDLAEPTI','JDW3PYPC','BA7PMBU9','M5L3PKDG','EEAJVYXR','79H4ZV7U','W1F4B24S','YBV2WDPU','VZ79E1RU','3SUSSYVI','THHUZ8BX','H925473T','PDE7WPB2','3IENE5X5','7XKJ7PW9','NLZCRASL','VRF39V1V','64BJ4AVD','2WKTCYYN','2P4K4N1C','SP1IYAZH','QQN8RXU2','AEKT5VHZ','G58QJB3X','DXICRJW7','95P82ZEJ','PZ456RS4','3BRRU3G2','2559LI3C','YSVF83A3','ZPN6JNFQ','PP835MIX')

SELECT PRTCPT_DVC_ID FROM ROADMAP.PRTCPT_DVC  WHERE STUDY_PRTCPT_ID IN ('CTCF3BLF', 'HP5X93MQ','D2M2ZZYX','3S7LUJ1V','WTI3RXPU','81AAL6VD','RDLAEPTI','JDW3PYPC','BA7PMBU9','M5L3PKDG','EEAJVYXR','79H4ZV7U','W1F4B24S','YBV2WDPU','VZ79E1RU','3SUSSYVI','THHUZ8BX','H925473T','PDE7WPB2','3IENE5X5','7XKJ7PW9','NLZCRASL','VRF39V1V','64BJ4AVD','2WKTCYYN','2P4K4N1C','SP1IYAZH','QQN8RXU2','AEKT5VHZ','G58QJB3X','DXICRJW7','95P82ZEJ','PZ456RS4','3BRRU3G2','2559LI3C','YSVF83A3','ZPN6JNFQ','PP835MIX')

SELECT * FROM ROADMAP.STUDY_METRIC_STEPS WHERE PRTCPT_DVC_ID IN (23294, 23273, 23274, 23293, 25414, 25433, 25454, 25953, 26035, 26575, 26594, 26595, 26793, 26794, 26813, 26814, 27113, 27114, 27115, 24834, 25973, 25974, 26073, 26074, 26654, 24814, 24815, 24833, 25253, 25273, 25373, 25374, 26193, 26473, 26474, 26493, 26494, 26573, 26653, 26933, 23973, 24276, 24373, 24374, 24375, 24393, 25376, 26034, 26213, 26313, 26413, 26414, 26453, 26576, 26593, 27333, 27513, 24273, 24274, 24275, 25375, 25453, 25893, 25913, 26574, 27055, 27373, 23953, 23954, 23993, 25233, 25234, 25853, 26233, 26234, 25393, 25933, 26314, 26433, 27033)

SELECT * FROM ROADMAP.STUDY_METRIC_STEPS WHERE PRTCPT_DVC_ID IN (23294, 23273)

SELECT * FROM ROADMAP.STUDY_METRIC_STEPS WHERE  PRTCPT_DVC_ID IN (23294, 23273, 23274, 23293, 25414, 25433, 25454, 25953, 26035, 26575, 26594, 26595, 26793, 26794, 26813, 26814, 27113, 27114, 27115, 24834, 25973, 25974, 26073, 26074, 26654, 24814, 24815, 24833, 25253, 25273, 25373, 25374, 26193, 26473, 26474, 26493, 26494, 26573, 26653, 26933, 23973, 24276, 24373, 24374, 24375, 24393, 25376, 26034, 26213, 26313, 26413, 26414, 26453, 26576, 26593, 27333, 27513, 24273, 24274, 24275, 25375, 25453, 25893, 25913, 26574, 27055, 27373, 23953, 23954, 23993, 25233, 25234, 25853, 26233, 26234, 25393, 25933, 26314, 26433, 27033) AND study_metric_typ_id = 4;


SELECT * FROM ROADMAP.STUDY_METRIC_STEPS WHERE  PRTCPT_DVC_ID IN (23294, 23273, 23274,6433, 27033) AND study_metric_typ_id = '4';

select *from roadmap.STUDY_METRIC_HEARTRATE where PRTCPT_DVC_ID IN (1558,1561,1563,1572,1577,1613,1616,1650)

select *from roadmap.STUDY_METRIC_HEARTRATE where PRTCPT_DVC_ID = 1561  AND STUDY_METRIC_MSR_START_DT >= '2021-01-24 00:00:00' AND STUDY_METRIC_MSR_START_DT <= '2021-01-24 23:59:00'

SELECT * FROM ROADMAP.PRTCPT_DVC WHERE STUDY_PRTCPT_ID IN ('CFI9I6K2', 'PF1BLPH4', '4UDRUW84', 'B51FUYGC', 'FRSQKIQF', 'U82WP671', 'BNI9GAY5', 'IUPUFELI', 'M6WWDSQA', 'SVIXFL83')

SELECT * FROM ROADMAP.PRTCPT_DVC WHERE STUDY_PRTCPT_ID IN ('CFI9I6K2', 'PF1BLPH4')

SELECT *FROM ROADMAP.PRTCPT_DVC WHERE PRTCPT_DVC_ID = 4215

SELECT *FROM ROADMAP.STUDY_METRIC_HEARTRATE WHERE PRTCPT_DVC_ID IN (  1935, 1724, 4153, 9072, 9899, 9646, 9648, 9711, 10023, 9645,
  9647, 9864, 9885, 9889, 9866, 9881, 10896, 10321, 11333, 11893,
  12115, 11740, 12273, 12851, 17653, 17655, 17656, 20813, 21053, 21173,
  21353, 21413, 21433, 21453, 21593, 22013, 22653, 23394, 23773, 23833,
  21113, 21594, 21793, 21833, 21873, 22133, 22273, 17658, 20437, 21213,
  21393, 21653, 21853, 21933, 21973, 22033, 22313, 22493, 22553, 22573,
  22673, 22693, 22773, 23153, 23173, 23253, 18753, 20153, 21013, 21153,
  21233, 21313, 21317, 21534, 21553, 21662, 21713, 20793, 20833, 20913,
  21455, 21473, 21513, 21613, 21693, 22113, 22453, 22613, 22713, 22733,
  20435, 20436, 21573, 21753, 22073, 22433, 22793, 22953, 22973, 22993,
  23053, 23133, 23213, 23313, 23433, 23473, 18637, 20053, 21454, 21474,
  21557, 21773, 21893, 21953, 22093, 22413, 22633, 22833, 23093, 23113,
  23233, 23413, 23513, 23533, 23553, 23593, 23613, 23633, 18673, 19293,
  20093, 20893, 21033, 21133, 21813, 21913, 21993, 22173, 22333, 22353,
  22873, 23673, 23674, 23693, 23713, 23753, 23793, 23794, 23913, 23873)
  
SELECT *FROM ROADMAP.STUDY_METRIC_HEARTRATE WHERE PRTCPT_DVC_ID in ( 4215 , 3724) ORDER BY TO_DATE(STUDY_METRIC_MSR_START_DT,'YYYY-MM-DD HH24:MI:SS')

SELECT DISTINCT PRTCPT_DVC_ID
FROM ROADMAP.STUDY_METRIC_STEPS
WHERE PRTCPT_DVC_ID IN (25813, 28173, 24073, 24673, 24793, 27256, 27693, 25035, 25313, 25653, 24259, 24754, 25533, 23873, 24033, 25013, 25073, 26295, 27594, 27733, 27753, 27833, 27893, 29116, 21853, 21933, 21973, 22313, 22374, 22493, 22573, 22673, 22773, 23173, 23379, 21013, 21233, 21317, 21534, 21657, 21662, 21713, 21734, 18896, 21273, 21374, 21455, 21613, 22113, 22713, 22073, 22155, 22433, 22593, 22953, 22993, 23133, 23313, 23455, 23473, 19733, 21474, 21557, 21773, 21893, 22633, 22833, 23093, 23233, 23378, 23413, 23533, 23593, 23633, 19113, 20893, 21133, 21813, 22173, 22353, 23674, 23713, 23794, 24456, 24936, 27474, 23896, 24856, 1332, 1717, 1418, 1261, 1364, 7170, 5413, 9154, 9569, 9711, 9668, 9840, 9879, 9884, 9937, 10039, 9935, 10896, 11095, 10744, 10321, 10327, 10922, 10538, 10556, 10673, 10800, 11156, 11236, 10707, 10913, 10199, 10375, 10536, 10638, 11395, 12175, 11455, 12335, 11674, 11893, 11493, 12116, 12254, 12273, 12851, 15946, 14818, 14943, 17155, 20813, 21053, 21173, 21433, 21593, 22013, 23773, 19613, 20957, 21660, 19094, 19794, 20437, 21393, 1718, 1935, 1417, 1724, 1259, 1365, 4153, 4214, 4216, 4733, 5562, 8314, 9072, 9056, 9899, 10040, 10087, 9566, 9532, 10023, 9645, 9864, 9885, 9889, 9891, 9716, 9866, 9881, 10328, 10373, 10374, 10537, 10557, 10639, 10682, 10804, 10897, 11138, 10416, 10417, 10456, 10649, 10809, 10899, 10921, 10960, 11235, 11278, 10517, 10539, 10851, 10915, 10976, 11155, 10625, 10627, 10743, 10807, 10990, 11097, 11277, 10706, 10757, 10914, 11333, 10176, 10200, 10318, 10335, 10382, 10731, 11675, 11739, 13553, 14313, 12314, 11436, 14198, 11655, 12115, 12867, 11740, 12336, 13876, 11873, 13987, 11473, 11576, 12176, 12253, 12494, 11396, 14682, 14819, 14942, 15949, 17676, 18615, 18895, 21293, 21353, 21413, 21453, 22653, 23394, 23815, 23833, 18253, 19034, 20376, 20493, 20613, 21113, 21594, 21735, 21793, 21833, 21873, 22133, 22273, 16721, 17658, 19093, 19553, 20441, 20955, 21213, 21653, 22033, 22055, 22553, 22693, 23153, 23253, 18753, 19473, 20153, 21153, 21313, 21553, 21656, 21661, 17135, 18154, 19395, 19415, 20793, 20833, 20913, 21373, 21473, 21513, 21693, 22453, 22533, 22613, 22733, 19634, 20313, 20355, 20574, 21573, 21753, 22253, 22793, 22973, 23053, 23213, 23393, 23433, 23456, 18637, 18913, 18935, 19734, 19934, 20053, 20457, 20533, 20956, 21454, 21953, 22093, 22413, 23113, 23353, 23377, 23513, 23553, 23613, 18617, 18673, 19293, 19374, 19795, 20093, 21033, 21913, 21993, 22333, 22373, 22873, 22914, 23033, 23673, 23693, 23753, 23793, 24455, 24693, 25593, 25633, 27233, 27255, 27973, 23895, 24074, 24495, 24553, 24575, 24614, 24855, 24935, 28035, 28155, 23913, 26275, 27154, 27214, 27955, 24295, 24715, 24794, 25036, 25833, 26634, 26853, 27473, 24015, 24113, 24255, 25873, 28213, 28293, 24175, 24753, 24916, 25353, 25534, 25773, 27634, 24195, 24313, 24335, 24875, 25074, 25175, 26173, 27593, 27656, 27734, 27834, 27873, 29115, 19493, 19533, 20375, 20458, 20573, 20653, 23034, 18616, 18936, 19933, 20440, 22913, 24475, 25473, 27213, 27633, 24633, 28036, 24496, 25354, 27153, 27956, 24196, 26633, 28214, 28313, 24176, 24213, 24296, 24336, 24716, 24893, 24915, 25713, 28095, 24258, 25176, 25753, 26174, 27655, 28073, 1725, 4215, 4217, 3173, 5556, 10073, 9669, 9715, 9892, 10058, 10180, 10686, 10803, 10852, 11033, 10895, 10953, 11139, 10789, 10626, 10989, 11281, 10334, 10681, 10916, 11273, 11276, 10175, 10319, 10383, 10732, 10808, 13554, 11853, 12213, 12493, 14197, 11737, 11815, 13875, 13986, 14173, 11575, 12073, 12313, 12917, 17675, 19396, 20513, 22534, 23816, 20393, 19513, 20415, 17273, 19313, 19373, 18153, 19416, 19275, 22056, 23193, 23194, 23354, 20173, 19233, 19215, 18713, 20274, 20295, 19193, 17775, 19673, 17595, 20033, 20193, 19813, 20233, 19674, 19893, 20213, 17743, 19853, 17594, 19333)
  AND TO_CHAR(TO_DATE(STUDY_METRIC_MSR_START_DT, 'YYYY-MM-DD HH24:MI:SS'), 'SS') != '00';
  
  SELECT DISTINCT PRTCPT_DVC_ID
FROM ROADMAP.STUDY_METRIC_STEPS
WHERE PRTCPT_DVC_ID IN (4215,24673)
  AND TO_CHAR(TO_DATE(STUDY_METRIC_MSR_START_DT, 'YYYY-MM-DD HH24:MI:SS'), 'SS') != '00';
  
SELECT *
FROM ROADMAP.STUDY_METRIC_STEPS
WHERE TO_DATE(STUDY_METRIC_MSR_START_DT, 'YYYY-MM-DD HH24:MI:SS')
    BETWEEN TO_DATE('2023-07-22 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
    AND TO_DATE('2023-07-23 00:00:00', 'YYYY-MM-DD HH24:MI:SS');
    
    
SELECT * FROM ROADMAP.STUDY_METRIC_HEARTRATE WHERE PRTCPT_DVC_ID IN(20813,21053,21173,21433,21593,22013,23773,20437,21393,21853,21933,21973,22313,22493,22573,22673,22773,23173,21013,21233,21317,21534,21662,21713,21455,21613,22113,22713,20435,22073,22433,22953,22993,23133,23313,23473,21474,21557,21773,21893,22633,22833,23093,23233,23413,23533,23593,23633,20893,21133,21813,22173,22353,23674,23713,23794,23873)   

SELECT STUDY_METRIC_MSR_START_DT,
       MAX(TO_NUMBER(STUDY_METRIC_MSR_VAL)) - MIN(TO_NUMBER(STUDY_METRIC_MSR_VAL)) as val_difference 
FROM ROADMAP.STUDY_METRIC_HEARTRATE WHERE PRTCPT_DVC_ID IN(20813,21053,21173,21433,21593,22013,23773,20437,21393,21853,21933,21973,22313,22493,22573,22673,22773,23173,21013,21233,21317,21534,21662,21713,21455,21613,22113,22713,20435,22073,22433,22953,22993,23133,23313,23473,21474,21557,21773,21893,22633,22833,23093,23233,23413,23533,23593,23633,20893,21133,21813,22173,22353,23674,23713,23794,23873)   
GROUP BY STUDY_METRIC_MSR_START_DT 
HAVING MAX(TO_NUMBER(STUDY_METRIC_MSR_VAL)) - MIN(TO_NUMBER(STUDY_METRIC_MSR_VAL)) <> 0;

SELECT STUDY_METRIC_MSR_START_DT,
       MAX(TO_NUMBER(STUDY_METRIC_MSR_VAL)) - MIN(TO_NUMBER(STUDY_METRIC_MSR_VAL)) as val_difference, COUNT(distinct(PRTCPT_DVC_ID)) AS num_devices
FROM ROADMAP.STUDY_METRIC_HEARTRATE WHERE PRTCPT_DVC_ID IN(20813,21053,21173,21433,21593,22013,23773,20437,21393,21853,21933,21973,22313,22493,22573,22673,22773,23173,21013,21233,21317,21534,21662,21713,21455,21613,22113,22713,20435,22073,22433,22953,22993,23133,23313,23473,21474,21557,21773,21893,22633,22833,23093,23233,23413,23533,23593,23633,20893,21133,21813,22173,22353,23674,23713,23794,23873)   -- These are 57 devices 
GROUP BY STUDY_METRIC_MSR_START_DT 
HAVING MAX(TO_NUMBER(STUDY_METRIC_MSR_VAL)) - MIN(TO_NUMBER(STUDY_METRIC_MSR_VAL)) <> 0;

select * from roadmap.STUDY_METRIC_HEARTRATE where PRTCPT_DVC_ID in (20813,21053,21173,21433,21593,22013)

select * from roadmap.STUDY_METRIC_HEARTRATE where PRTCPT_DVC_ID IN(20813,21053,21173,21433,21593,22013,23773,20437,21393,21853,21933,21973,22313,22493,22573,22673,22773,23173,21013,21233,21317,21534,21662,21713,21455,21613,22113,22713,20435,22073,22433,22953,22993,23133,23313,23473,21474,21557,21773,21893,22633,22833,23093,23233,23413,23533,23593,23633,20893,21133,21813,22173,22353,23674,23713,23794,23873) and STUDY_METRIC_MSR_START_DT  = '2022-03-03 02:53:00'   


SELECT COUNT(distinct(PRTCPT_DVC_ID))AS unique_device_count FROM ROADMAP.prtcpt_dvc where PRTCPT_DVC_ID in (20813,21053,21173,21433,21593,22013,23773,20437,21393,21853,21933,21973,22313,22493,22573,22673,22773,23173,21013,21233,21317,21534,21662,21713,21455,21613,22113,22713,20435,22073,22433,22953,22993,23133,23313,23473,21474,21557,21773,21893,22633,22833,23093,23233,23413,23533,23593,23633,20893,21133,21813,22173,22353,23674,23713,23794,23873)   
-----------------------------------------------------------------------------------------------------------------------
SELECT *FROM ROADMAP.PRTCPT_DVC WHERE PRTCPT_DVC_TYP_ID = 1 AND STUDY_PRTCPT_ID = 'PF1BLPH4' -- These two have same internal device IDs and they represent a patient caregiver dyad
SELECT *FROM ROADMAP.PRTCPT_DVC WHERE PRTCPT_DVC_TYP_ID = 1 AND STUDY_PRTCPT_ID = 'CFI9I6K2' 
-----------------------------------------------------------------------------------------------------------------------
SELECT * FROM ROADMAP.PRTCPT_DVC WHERE STUDY_PRTCPT_ID IN ('CFI9I6K2', 'PF1BLPH4', '4UDRUW84', 'B51FUYGC', 'FRSQKIQF', 'U82WP671', 'BNI9GAY5', 'IUPUFELI', 'M6WWDSQA', 'SVIXFL83') AND PRTCPT_DVC_TYP_ID = 1

SELECT DISTINCT(PRTCPT_DVC_INTERNAL_ID)  FROM ROADMAP.PRTCPT_DVC WHERE STUDY_PRTCPT_ID IN ('CFI9I6K2', 'PF1BLPH4', '4UDRUW84', 'B51FUYGC', 'FRSQKIQF', 'U82WP671', 'BNI9GAY5', 'IUPUFELI', 'M6WWDSQA', 'SVIXFL83') AND PRTCPT_DVC_TYP_ID = 1

SELECT * FROM ROADMAP.PRTCPT_DVC WHERE STUDY_PRTCPT_ID IN ('CFI9I6K2', 'PF1BLPH4', '4UDRUW84', 'B51FUYGC', 'FRSQKIQF', 'U82WP671', 'BNI9GAY5', 'IUPUFELI', 'M6WWDSQA', 'SVIXFL83') AND PRTCPT_DVC_TYP_ID = 1

SELECT DISTINCT TO_CHAR(TO_DATE(STUDY_METRIC_MSR_START_DT, 'YYYY-MM-DD HH24:MI:SS'), 'YYYY-MM-DD') as distinct_days FROM ROADMAP.STUDY_METRIC_HEARTRATE WHERE PRTCPT_DVC_ID =1558;

-- Find the time of MOOD entry for the student wellness group Here. 

SELECT COUNT(DISTINCT(STUDY_PRTCPT_ID)) FROM ROADMAP.PRTCPT_DVC WHERE STUDY_PRTCPT_ID IN ('RYFXBDFQ', 'XGJ8AFS8', 'TQLY4RDR', 'MLYS5U85', 'UQUEK1XU', '8MRVHIRR', 'VL61MMTY', 'YRTQ7TKL', 'IS69SBYZ', 'T4CSRKVM', '15LGWNGJ', '1X8MBFBA', 'N5F15GYZ', 'Y8PEMP7K', 'D1C3M5J2', 'RQ5P4ZR8', 'W7LX2I74', '3IJBZPI8', '5NQHT686', 'M5ENQMEA', 'SBTLFFUR', 'F1MALNM8', 'JEW6KQY3', 'VZK8IVKE', 'XKZF8SDS', 'JU3R5P4M', 'KL8ZU5XC', 'CCD84K8N')

