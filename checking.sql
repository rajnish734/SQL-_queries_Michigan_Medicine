SELECT * FROM ROADMAP.STUDY_METRIC_STEPS WHERE TO_CHAR(TO_DATE(STUDY_METRIC_MSR_START_DT, 'YYYY-MM-DD HH24:MI:SS'), 'MI') = '00' AND PRTCPT_DVC_ID IN (26154, 26674, 27314, 26754, 26774, 26916, 27294, 27394, 27533, 26133, 26294, 26355, 26694, 26714, 26334, 26894, 26953, 27054, 27174, 27354, 26274, 26555, 27553, 26176, 26178, 27035, 27414);



SELECT * FROM ROADMAP.STUDY_METRIC_STEPS WHERE TO_CHAR(TO_DATE(STUDY_METRIC_MSR_START_DT, 'YYYY-MM-DD HH24:MI:SS'), 'SS') != '00' AND PRTCPT_DVC_ID IN (26154, 26674, 27414); /* Note - It took 412 seconds to execute. Answer was an exmpty matrix */

SELECT * FROM ROADMAP.STUDY_METRIC_STEPS WHERE TO_CHAR(TO_DATE(STUDY_METRIC_MSR_START_DT, 'YYYY-MM-DD HH24:MI:SS'), 'SS') != '00' AND PRTCPT_DVC_ID IN (26154); /* Note - It took 412 seconds to execute. Answer was an exmpty matrix */

SELECT * FROM ROADMAP.STUDY_METRIC_HEARTRATE where prtcpt_dvc_id = 25
SELECT * FROM ROADMAP.STUDY_METRIC_HEARTRATE WHERE TO_CHAR(TO_DATE(STUDY_METRIC_MSR_START_DT, 'YYYY-MM-DD HH24:MI:SS'), 'SS') = '00' AND PRTCPT_DVC_ID IN (26154, 26674, 27314, 26754, 26774, 26916, 27294, 27394, 27533, 26133, 26294, 26355, 26694, 26714, 26334, 26894, 26953, 27054, 27174, 27354, 26274, 26555, 27553, 26176, 26178, 27035, 27414);
SELECT * FROM ROADMAP.STUDY_METRIC_HEARTRATE WHERE TO_CHAR(TO_DATE(STUDY_METRIC_MSR_START_DT, 'YYYY-MM-DD HH24:MI:SS'), 'SS') != '00' 

SELECT * FROM ROADMAP.STUDY_METRIC_HEARTRATE WHERE PRTCPT_DVC_ID = 1332  /* This is some device in BMT. Heart rate is coming at non-zero values of seconds. */
SELECT * FROM ROADMAP.STUDY_METRIC_HEARTRATE WHERE TO_CHAR(TO_DATE(STUDY_METRIC_MSR_START_DT, 'YYYY-MM-DD HH24:MI:SS'), 'SS') != '00' AND PRTCPT_DVC_ID = 1332

SELECT * FROM ROADMAP.STUDY_METRIC_HEARTRATE WHERE TO_CHAR(TO_DATE(STUDY_METRIC_MSR_START_DT, 'YYYY-MM-DD HH24:MI:SS'), 'SS') != '00' AND PRTCPT_DVC_ID = 20813

SELECT * FROM ROADMAP.STUDY_METRIC_HEARTRATE WHERE PRTCPT_DVC_ID = 20813 AND STUDY_METRIC_MSR_START_DT = '2022-03-04 01:13:00'

SELECT * FROM ROADMAP.STUDY_METRIC_HEARTRATE WHERE PRTCPT_DVC_ID = 20813 

select * from ROADMAP.STUDY_METRIC_HEARTRATE where PRTCPT_DVC_ID = 1332 and STUDY_METRIC_MSR_START_DT LIKE '2020-11-11%' ORDER BY STUDY_METRIC_MSR_START_DT ASC /* arrange them in an ascending order just to make sure*/
select * from ROADMAP.STUDY_METRIC_HEARTRATE where PRTCPT_DVC_ID = 1418 and STUDY_METRIC_MSR_START_DT LIKE '2020-11-16%' ORDER BY STUDY_METRIC_MSR_START_DT ASC 
select * from ROADMAP.STUDY_METRIC_HEARTRATE where PRTCPT_DVC_ID = 1332
select * from ROADMAP.STUDY_METRIC_HEARTRATE where PRTCPT_DVC_ID = 1418 and STUDY_METRIC_MSR_START_DT LIKE '2020-11-16 02%' ORDER BY STUDY_METRIC_MSR_START_DT ASC 


SELECT TO_DATE(SUBSTR(STUDY_METRIC_MSR_START_DT, 1, 10), 'YYYY-MM-DD') AS metric_date,
       COUNT(*) AS total_entries,
       COUNT(DISTINCT STUDY_METRIC_MSR_START_DT) AS unique_entries,
       COUNT(*) - COUNT(DISTINCT STUDY_METRIC_MSR_START_DT) AS repeated_entries,
       COUNT(CASE WHEN STUDY_METRIC_TYP_ID = 2 THEN 1 END) AS typ_id_2_count,
       COUNT(CASE WHEN STUDY_METRIC_TYP_ID = 20 THEN 1 END) AS typ_id_20_count,
       COUNT(CASE WHEN STUDY_METRIC_TYP_ID = 4 THEN 1 END) AS typ_id_4_count,
       COUNT(CASE WHEN STUDY_METRIC_TYP_ID = 5 THEN 1 END) AS typ_id_5_count,
       COUNT(CASE WHEN STUDY_METRIC_TYP_ID = 6 THEN 1 END) AS typ_id_6_count,
       COUNT(CASE WHEN STUDY_METRIC_TYP_ID = 7 THEN 1 END) AS typ_id_7_count
FROM roadmap.STUDY_METRIC_STEPS
WHERE PRTCPT_DVC_ID = 26154
GROUP BY TO_DATE(SUBSTR(STUDY_METRIC_MSR_START_DT, 1, 10), 'YYYY-MM-DD')
ORDER BY metric_date;
